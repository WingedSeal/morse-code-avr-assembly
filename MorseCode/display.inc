.macro handleDisplay
	; R22 = index in Y
	; R23 = Y length
	TST R23
	BRNE _IS_NOT_ZERO
		LDI R16, DASH
		OUT PORTD, R16
		RJMP _HANDLE_DISPLAY_DONE
		LDI R16, 0xFF
		OUT PORTB, R16

	_IS_NOT_ZERO:
	INC R22
	CP R22, R23 ; R22 == R23 - 1
	BRNE _IS_NOT_RIGHT_EDGE
	; _IS_RIGHT_EDGE
		SBI PORTB, 1
		RJMP _CONTINUE_RIGHT_EDGE
	_IS_NOT_RIGHT_EDGE:
		CBI PORTB, 1
	_CONTINUE_RIGHT_EDGE:
	DEC R22

	TST R22
	BRNE _IS_NOT_LEFT_EDGE
	; _IS_LEFT_EDGE
		SBI PORTB, 0
		RJMP _CONTINUE_LEFT_EDGE
	_IS_NOT_LEFT_EDGE:
		CBI PORTB, 0
	_CONTINUE_LEFT_EDGE:

	LD R16, Y
	.IFDEF _DEBUG
	CALL send_char
	.ENDIF
	OUT PORTD, R16
	_HANDLE_DISPLAY_DONE:
.endmacro